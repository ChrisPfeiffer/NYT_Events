<!DOCTYPE html>
<html>

<head>
  <title>Events in New York</title>    
  <style type="text/css">
  html, body { height: 100%; margin: 0; padding: 0; }
  #map { height: 60%; }
  </style>
</head>

<body>
  <ul id="events"></ul>
  <div id="map"></div>

  <!-- bring in the backbone libraries-->

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
  <script src="http://ajax.cdnjs.com/ajax/libs/underscore.js/1.1.4/underscore-min.js"></script>
  <script src="http://ajax.cdnjs.com/ajax/libs/backbone.js/0.3.3/backbone-min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD5_EfcE8JN5H8FFL1eTYUTahS-jIeYp6U&sensor=true"></script>
  
  <!--create th map opject-->
  <script type="text/javascript">

    $(document).ready(initMap);

  var map;
  function initMap() {
    var latlng = new google.maps.LatLng(40.7127,-74.0059);
    var options = {
        zoom: 15,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
  };

  map = new google.maps.Map(document.getElementById('map'), options);
  
  var marker = new google.maps.Marker({
    position: {lat: 40.7127, lng: -74.0059},
    map: map,
    title: 'First Marker!'
  })

  $.getJSON('http://events2339.azurewebsites.net/api/events/getevents', function (jsonPayload) {
    $.each(jsonPayload, function(i, item){
      var marker = new google.maps.Marker({
        position: {lat: parseFloat(item.geocode_latitude), lng: parseFloat(item.geocode_longitude)},
        map: map,
        title: 'test_title'
      });

    });

    map.addListener('idle', function()
    {
      var bounds = map.getBounds();
      console.log(bounds);
    });

  });      
};



  
  </script>
</body>
</html>